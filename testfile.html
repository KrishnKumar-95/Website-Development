<!-- File loader WebApp to Google Drive in Records sheet by #codewithcurt-->


<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <script>
        function LoadFile(event) {
            var file = event.target.files[0];
            var reader = new FileReader();
            reader.onload = function(e) {
                console.log(e.target.result);
                var fileData = e.target.result.substr(e.target.result.indexOf(",") + 1);
                var mimeTypeStart = e.target.result.indexOf("data:") + 5;
                var mimeTypeEnd = e.target.result.indexOf(";");
                var mimeType = e.target.result.substr(mimeTypeStart, mimeTypeEnd - mimeTypeStart);
                var fileName = file.name;
                document.getElementById("fileData").value = fileData;
                document.getElementById("mimeType").value = mimeType;
                document.getElementById("fileName").value = fileName;
            };
            reader.readAsDataURL(file);
        }
    </script>
    <style>
        .flex {
            display: flex;
            justify-content: center;
        }
        
        .title {
            font-weight: 700;
        }
        
        body {
            background-color: rgb(204, 237, 250);
        }
    </style>
</head>

<body>
    <h1 class="flex" ; style="color: navy;"><u>B.Ed Admissions for session 2021-23</u></h1>
    <h3 class="flex" ;>>>> Document Upload Section
        <<<</h3>
            <?var url = getUrl();?>
                <form method="post" action="<?= url ?>">
                    <table cellpadding="5px" class="flex">
                        <tr>
                            <td class="title" ;>Email id:</td>
                            <td><input type="text" name="username" /></td>
                        </tr>
                        <tr>
                            <td class="title" ;>File:</td>
                            <td><input type="file" name="file" onchange="LoadFile(event)" />
                                <input type="hidden" id="fileData" name="fileData" />
                                <input type="hidden" id="mimeType" name="mimeType" />
                                <input type="hidden" id="fileName" name="fileName" /></td>
                        </tr>
                        <tr>
                            <td colspan="2"><input type="submit" value="Upload File" /></td>
                        </tr>
                        <tr>
                            <td colspan="2"><span><?= message ?></span></td>
                </form>
</body>

</html>